{% extends 'base.html' %}

{% block title %}
    Listas
{% endblock %}

{% block poshead %}
    {% load staticfiles %}
    <link rel="stylesheet" href="{% static 'css/print/formatos.css' %}" type="text/css" media="print" />
    <script type="text/javascript">
    function ConfirmarEnvio(ref)
    {
        mensaje = "Recuerde que las asistencias solo pueden enviarse una \
                    vez, y no pueden modificarse posteriormente.\n \
                    Revise bien la información antes de continuar. \n\n \
                    ¿Desea proceder con el envio?";

        return confirm(mensaje);
    }
    </script>
    {% if yaRegistradas %}
    <style type="text/css">.assist-col { display: none !important; }</style>
    {% endif %}
{% endblock %}

{% block content %}
    <div class="row">
        <div class="medium-12 columns">
            
            {# Lista de docentes tiempo completo #}
            {% if tiempoC %}
            <div class="row">
                <div class="medium-12 columns">
                    <h4 style="text-align: center">Centro Universitario de Ciencias Exactas e Ingenierías</h4>
                    {% if yaRegistradas %}
                        <div class="alert-box warning radius text-center hide-for-print">
                            Las asistencias del día ya fueron registradas
                        </div>
                    {% endif %}
                    <hr>

                    <button class="button tiny hide-for-print right" onclick="print()">Imprimir formato</button>
                    <table class="full-width-table">
                        <thead>
                            <tr>
                                <th rowspan="2" class="hide-for-print">N°</th>
                                <th>{{ today }}</th>
                                <th colspan="2">ENTRADA</th>
                                <th colspan="2">SALIDA</th>
                                <th rowspan="2" class="hide-for-print assist-col">Asistencia</th>
                            </tr>
                            <tr> 
                                <th>NOMBRE</th>
                                <th>HORA</th>
                                <th class="sign-field text-center">FIRMA</th>
                                <th>HORA</th>
                                <th class="sign-field text-center">FIRMA</th>
                            </tr>
                        </thead>

                        <tbody>
                            <form method="POST">{% csrf_token %}
                            {% for x in listaAsistencia %}
                                <tr>
                                    <td class="hide-for-print">{{ forloop.counter }}</td>
                                    <td class="row-nombre">{{ x.profesor }}</td>
                                    <td class="row-hora-in">{{ x.hora_ini }}</td>
                                    <td class="row-sign">{# firma #}</td>
                                    <td class="row-hora-in">{{ x.hora_fin }}</td>
                                    <td class="row-sign">{# firma #}</td>
                                    <td class="hide-for-print assist-col">
                                        <input type="hidden" name="{{x.codigo_prof}}" value="off" />
                                        <input type="checkbox" id="asistencia" name="{{x.codigo_prof}}" checked/>
                                    </td>
                                </tr>
                            {% endfor %}
                            <tr class="hide-for-print">
                                <td colspan="7"><input type="submit" class="button expand" onclick="return ConfirmarEnvio(this);" value="Registrar Asistencias" {% if yaRegistradas == True or not listaContratos %}disabled{% endif %}/></td>
                            </tr>
                            </form>
                        </tbody>
                    </table>
                </div>
            </div>
            {% endif %}

            {# Lista de docentes de medio tiempo #}
            {% if tiempoM %} 
            <div class="row">
                <div class="medium-12 columns">
                    <button class="button tiny right hide-for-print" onclick="print()">Imprimir formato</button>
                    <table class="full-width-table">
                        {% if yaRegistradas %}
                        <div class="alert-box warning radius text-center hide-for-print">
                            Las asistencias del día ya fueron registradas
                        </div>
                        {% endif %}
                        <thead>
                            <tr class="especialHead">
                                {# <th class="hide-for-print"></th> #}
                                <th colspan="2">
                                    {% load staticfiles %}
                                    <img style="height: 180px;" src="{% static 'img/udglogo.jpg' %}">
                                </th>

                                <th style="text-align: center" colspan="3">
                                    UNIVERSIDAD DE GUADALAJARA<br>
                                    {{ departamento|upper }}<br>
                                    LISTADO DE FIRMAS {{ dayWeek }}
                                </th>
                                <th colspan="3">
                                    FECHA <u>&nbsp;&nbsp;{{ day }} {{ month }} {{ year }}&nbsp;&nbsp;</u>
                                </th>
                                 <th class="hide-for-print assist-col"></th>
                            </tr>
                            <tr>
                                <th rowspan="2" class="hide-for-print">N°</th>
                                <th>NRC</th>
                                <th>NOMBRE</th>
                                <th>MATERIA</th>
                                <th>SEC</th>
                                <th>EDIF.</th>
                                <th>AULA</th>
                                <th>HOR.</th>
                                <th class="sign-field text-center">FIRMA</th>
                                <th class="hide-for-print assist-col">Asistencia</th>
                            </tr>
                        </thead>

                        <tbody>
                            <form method="POST">{% csrf_token %}
                            {% for x in listaContratos %}
                                <tr>
                                    <td class="hide-for-print">{{ forloop.counter }}</td>
                                    <td class="row-nrc">{{ x.fk_curso.NRC }}</td>
                                    <td class="row-nombreprof">{{ x.fk_curso.fk_profesor.apellido }} {{x.fk_curso.fk_profesor.nombre}}</td>
                                    <td class="row-materia">{{ x.fk_curso.fk_materia.nombre }}</td>
                                    <td class="row-secc">{{ x.fk_curso.fk_secc.id }}</td>
                                    <td class="row-edif">
                                    {% for horario in x.fk_curso.fk_horarios.all %}
                                        {% if horario in horarios %}
                                            {{ horario.fk_edif.id }}{% if not forloop.last %}<br>{% endif %}
                                        {% endif %}
                                    {% endfor %}
                                    </td>
                                    <td class="row-aula">
                                    {% for horario in x.fk_curso.fk_horarios.all %}
                                        {% if horario in horarios %}
                                            {{ horario.fk_aula.nombre }}<br>   
                                        {% endif %}
                                    {% endfor %}
                                    </td>
                                    <td class="row-horario">
                                    {% for horario in x.fk_curso.fk_horarios.all %}
                                        {% if horario in horarios %}
                                            {{ horario.hora_ini }}-{{horario.hora_fin}}<br>  
                                        {% endif %}
                                    {% endfor %}
                                    </td>
                                    <td class="row-firma">{# firma #}</td>
                                    <td class="hide-for-print assist-col">
                                        <input type="hidden" name="{{x.id}}" value="off"/>
                                        <input type="checkbox" id="asistencia" name="{{x.id}}" checked/>
                                    </td>
                                </tr>
                            {% endfor %}
                            <tr class="hide-for-print">
                                <td colspan="10"><input type="submit" class="button expand" onclick="return ConfirmarEnvio(this);" {% if yaRegistradas == True or not listaContratos %}disabled{% endif %}/></td>
                            </tr>
                            </form>
                        </tbody>
                    </table>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
{% endblock %}